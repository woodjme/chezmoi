# Environment variables
export EDITOR=nvim
export PATH=$HOME/.local/bin:$HOME/bin:/usr/local/bin:$PATH

# OpenCode
export PATH=$HOME/.opencode/bin:$PATH

export ZSH="$HOME/.oh-my-zsh"

{{- if eq .chezmoi.os "darwin" }}
# macOS - Homebrew setup
eval "$(/opt/homebrew/bin/brew shellenv)"
{{- else if eq .chezmoi.os "linux" }}
# Linux - tfenv PATH
export PATH="$HOME/.tfenv/bin:$PATH"
{{- end }}

# Oh-my-zsh configuration
DISABLE_AUTO_UPDATE="true"  # Managed by chezmoi
ZSH_THEME=""  # Disabled - using Starship prompt
HIST_STAMPS="dd.mm.yyyy"
ZSH_CUSTOM=$ZSH/custom

# Plugins
plugins=(
  git
  zsh-autosuggestions
  aws
  terraform
  kubectl
)

source $ZSH/oh-my-zsh.sh

# Aliases
alias dul='du -hs * | sort -h'

# Terraform aliases
alias tfp='echo "terraform plan -out="tfplan" " && terraform plan -out="tfplan"'
alias tfa='echo terraform apply "tfplan" && terraform apply "tfplan"'
alias tfi='echo terraform init && terraform init'

{{- if eq .chezmoi.os "darwin" }}
# macOS-specific aliases
alias tailscale="/Applications/Tailscale.app/Contents/MacOS/Tailscale"
{{- else if eq .chezmoi.os "linux" }}
{{- if or (eq .chezmoi.osRelease.id "debian") (eq .chezmoi.osRelease.id "ubuntu") }}
# Debian/Ubuntu-specific aliases
# bat is installed as batcat on Debian/Ubuntu due to naming conflict
command -v batcat >/dev/null 2>&1 && alias bat='batcat'
{{- end }}
{{- end }}

# fzf integration
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# AWS SSO login helper
aws-sso() {
  local profile
  profile=$(aws configure list-profiles | fzf --prompt="AWS Profile > " --height=40% --reverse)
  [[ -n "$profile" ]] && aws sso login --profile "$profile"
}

# Initialize Starship prompt
eval "$(starship init zsh)"

# Disable oh-my-zsh RPROMPT interference
unset RPROMPT

# Source client-specific local config (not managed by chezmoi)
# Create ~/.zshrc.local for machine-specific aliases, config, secrets, etc.
[ -f ~/.zshrc.local ] && source ~/.zshrc.local
